version: 6.45.10

type: DeclarativeSource

check:
  type: CheckStream
  stream_names:
    - profiles

max_concurrent_async_job_count: "{{ config.get('max_concurrent_async_job_count', 10) }}"

definitions:
  streams:
    profiles:
      type: DeclarativeStream
      retriever:
        type: SimpleRetriever
        requester:
          use_cache: true
          $ref: "#/definitions/base_requester"
          path: v2/profiles?profileTypeFilter=seller,vendor
          http_method: GET
          request_headers:
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        decoder:
          type: JsonDecoder
      name: profiles
      primary_key:
        - profileId
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/profiles"
    profiles_filtered:
      type: DeclarativeStream
      retriever:
        type: SimpleRetriever
        requester:
          use_cache: true
          $ref: "#/definitions/base_requester"
          path: v2/profiles?profileTypeFilter=seller,vendor
          http_method: GET
          request_headers:
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
          record_filter:
            type: RecordFilter
            condition: >-
              {%- set requested_profiles = config.get("profiles", []) -%} {%-
              set requested_marketplace_ids = config.get("marketplace_ids", [])
              -%} {{ record["profileId"] in requested_profiles or
              record["accountInfo"]["marketplaceStringId"] in
              requested_marketplace_ids if requested_profiles or
              requested_marketplace_ids else True }}
        decoder:
          type: JsonDecoder
      name: profiles_filtered
      primary_key:
        - profileId
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/profiles_filtered"
    portfolios:
      type: DeclarativeStream
      name: portfolios
      primary_key:
        - portfolioId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: portfolios/list
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            includeExtendedDataFields: "true"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - portfolios
          schema_normalization: Default
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          pagination_strategy:
            type: CursorPagination
            cursor_value: "{{ response.get(\"nextToken\", {}) }}"
            stop_condition: "{{ not response.get(\"nextToken\", {}) }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - creationDate
              value: >-
                {{ (format_datetime(record['extendedData']['creationDateTime'],
                '%s') | int * 1000) +
                (format_datetime(record['extendedData']['creationDateTime'],
                '%f')[:3] | int) }}
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - lastUpdatedDate
              value: >-
                {{
                (format_datetime(record['extendedData']['lastUpdateDateTime'],
                '%s') | int * 1000) +
                (format_datetime(record['extendedData']['lastUpdateDateTime'],
                '%f')[:3] | int) }}
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - servingStatus
              value: "{{ record['extendedData']['servingStatus'] }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - statusReasons
              value: "{{ record['extendedData']['statusReasons'] }}"
        - type: RemoveFields
          field_pointers:
            - - extendedData
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/portfolios"
    sponsored_display_campaigns:
      type: DeclarativeStream
      retriever:
        type: SimpleRetriever
        requester:
          request_params:
            stateFilter: "{{ ','.join(config['state_filter']) }}"
          $ref: "#/definitions/base_requester"
          path: sd/campaigns
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      name: sponsored_display_campaigns
      primary_key:
        - campaignId
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_campaigns"
    sponsored_display_ad_groups:
      type: DeclarativeStream
      name: sponsored_display_ad_groups
      primary_key:
        - adGroupId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sd/adGroups
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_ad_groups"
    sponsored_display_product_ads:
      type: DeclarativeStream
      name: sponsored_display_product_ads
      primary_key:
        - adId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sd/productAds
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_product_ads"
    sponsored_display_targetings:
      type: DeclarativeStream
      name: sponsored_display_targetings
      primary_key:
        - targetId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sd/targets
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_targetings"
    sponsored_display_creatives:
      type: DeclarativeStream
      name: sponsored_display_creatives
      primary_key:
        - creativeId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sd/creatives
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_creatives"
    sponsored_display_budget_rules:
      type: DeclarativeStream
      name: sponsored_display_budget_rules
      primary_key:
        - ruleId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          #    Important: API docs contains incorrect endpoint path:
          #        sd/budgetRules - endpoint from API docs which always returns empty results
          #        sp/budgetRules - working endpoint
          path: sp/budgetRules # TODO: check/rename stream during next breaking changes
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - budgetRulesForAdvertiserResponse
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: pageSize
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 30
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_budget_rules"
    sponsored_brands_keywords:
      type: DeclarativeStream
      name: sponsored_brands_keywords
      primary_key:
        - adGroupId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sb/keywords
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            field_name: startIndex
            inject_into: request_parameter
          page_size_option:
            type: RequestOption
            field_name: count
            inject_into: request_parameter
          pagination_strategy:
            type: OffsetIncrement
            page_size: 100
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_brands_keywords"
    sponsored_brands_campaigns:
      type: DeclarativeStream
      name: sponsored_brands_campaigns
      primary_key:
        - campaignId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sb/v4/campaigns/list
          http_method: POST
          request_headers:
            Accept: application/vnd.sbcampaignresource.v4+json
            Content-Type: application/vnd.sbcampaignresource.v4+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            stateFilter: " {{ {'include': ','.join(config['state_filter'])} if config['state_filter'] else None }} "
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - campaigns
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_brands_campaigns"
    sponsored_brands_ad_groups:
      type: DeclarativeStream
      name: sponsored_brands_ad_groups
      primary_key:
        - adGroupId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sb/v4/adGroups/list
          http_method: POST
          request_headers:
            Accept: application/vnd.sbadgroupresource.v4+json
            Content-Type: application/vnd.sbadgroupresource.v4+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - adGroups
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_brands_ad_groups"
    sponsored_product_campaigns:
      type: DeclarativeStream
      name: sponsored_product_campaigns
      primary_key:
        - campaignId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/campaigns/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spCampaign.v3+json
            Content-Type: application/vnd.spCampaign.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            stateFilter: " {{ {'include': ','.join(config['state_filter'])} if config['state_filter'] else None }} "
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - campaigns
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_campaigns"
    sponsored_product_ad_groups:
      type: DeclarativeStream
      name: sponsored_product_ad_groups
      primary_key:
        - adGroupId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /sp/adGroups/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spAdGroup.v3+json
            Content-Type: application/vnd.spAdGroup.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - adGroups
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_ad_groups"
    sponsored_product_keywords:
      type: DeclarativeStream
      name: sponsored_product_keywords
      primary_key:
        - keywordId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/keywords/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spKeyword.v3+json
            Content-Type: application/vnd.spKeyword.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - keywords
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_keywords"
    sponsored_product_negative_keywords:
      type: DeclarativeStream
      name: sponsored_product_negative_keywords
      primary_key:
        - keywordId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/negativeKeywords/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spNegativeKeyword.v3+json
            Content-Type: application/vnd.spNegativeKeyword.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - negativeKeywords
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_negative_keywords"
    sponsored_product_campaign_negative_keywords:
      type: DeclarativeStream
      name: sponsored_product_campaign_negative_keywords
      primary_key:
        - keywordId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/campaignNegativeKeywords/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spCampaignNegativeKeyword.v3+json
            Content-Type: application/vnd.spCampaignNegativeKeyword.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - campaignNegativeKeywords
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_campaign_negative_keywords"
    sponsored_product_ads:
      type: DeclarativeStream
      name: sponsored_product_ads
      primary_key:
        - adId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/productAds/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spProductAd.v3+json
            Content-Type: application/vnd.spProductAd.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - productAds
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_ads"
    sponsored_product_targetings:
      type: DeclarativeStream
      name: sponsored_product_targetings
      primary_key:
        - targetId
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: sp/targets/list
          http_method: POST
          request_headers:
            Accept: application/vnd.spTargetingClause.v3+json
            Content-Type: application/vnd.spTargetingClause.v3+json
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - targetingClauses
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_targetings"
    sponsored_product_ad_group_bid_recommendations:
      type: DeclarativeStream
      name: sponsored_product_ad_group_bid_recommendations
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /sp/targets/bid/recommendations
          http_method: POST
          request_headers:
            Accept: application/vnd.spthemebasedbidrecommendation.v4+json
            Content-Type: application/vnd.spthemebasedbidrecommendation.v4+json
            Amazon-Advertising-API-Scope: "{{ stream_slice.parent_slice['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            adGroupId: "{{ stream_slice[\"adGroupId\"] }}"
            campaignId: "{{ stream_slice.extra_fields[\"campaignId\"] }}"
            recommendationType: BIDS_FOR_EXISTING_AD_GROUP
            targetingExpressions:
              - type: CLOSE_MATCH
              - type: LOOSE_MATCH
              - type: SUBSTITUTES
              - type: COMPLEMENTS
          error_handler:
            #    max_retries: 5
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 400
                error_message: >-
                  Skip current AdGroup because it does not support request
                  {response.request.url} for current profile
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 422
                error_message: >-
                  Skip current AdGroup because the ad group
                  {json.loads(response.request.body)['adGroupId']} does not have
                  any asins
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 404
                error_message: >-
                  Skip current AdGroup because the specified ad group has no
                  associated bid
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: nextToken
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: maxResults
          pagination_strategy:
            type: CursorPagination
            page_size: 100
            cursor_value: "{{ response.nextToken }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/sponsored_product_ad_groups"
              parent_key: adGroupId
              extra_fields:
                - - campaignId
              partition_field: adGroupId
        decoder:
          type: JsonDecoder
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - adGroupId
              value: "{{ stream_slice[\"adGroupId\"] }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - campaignId
              value: "{{ stream_slice.extra_fields[\"campaignId\"] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_ad_group_bid_recommendations"
    sponsored_product_ad_group_suggested_keywords:
      type: DeclarativeStream
      retriever:
        type: SimpleRetriever
        requester:
          request_params:
            maxNumSuggestions: 100
          $ref: "#/definitions/base_requester"
          path: v2/sp/adGroups/{{ stream_slice['adGroupId'] }}/suggested/keywords
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_slice.parent_slice['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            #    max_retries: 5
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 400
                error_message: >-
                  Skip current AdGroup because it does not support request
                  {response.request.url} for current profile
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 422
                error_message: >-
                  Skip current AdGroup because the ad group
                  {json.loads(response.request.body)['adGroupId']} does not have
                  any asins
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 404
                error_message: >-
                  Skip current AdGroup because the specified ad group has no
                  associated bid
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/sponsored_product_ad_groups"
              parent_key: adGroupId
              extra_fields:
                - - campaignId
              partition_field: adGroupId
        decoder:
          type: JsonDecoder
      name: sponsored_product_ad_group_suggested_keywords
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_product_ad_group_suggested_keywords"
    attribution_report_products:
      type: DeclarativeStream
      name: attribution_report_products
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /attribution/report
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            endDate: >-
              "{{
              format_datetime(today_with_timezone(stream_slice.extra_fields['timezone']).strftime('%Y%m%d'),
              '%Y%m%d', '%Y%m%d') }}"
            metrics: |
              {{
                ','.join([
                'attributedDetailPageViewsClicks14d',
                'attributedAddToCartClicks14d',
                'attributedPurchases14d',
                'unitsSold14d',
                'attributedSales14d',
                'brandHaloDetailPageViewsClicks14d',
                'brandHaloAttributedAddToCartClicks14d',
                'brandHaloAttributedPurchases14d',
                'brandHaloUnitsSold14d',
                'brandHaloAttributedSales14d',
                'attributedNewToBrandPurchases14d',
                'attributedNewToBrandUnitsSold14d',
                'attributedNewToBrandSales14d',
                'brandHaloNewToBrandPurchases14d',
                'brandHaloNewToBrandUnitsSold14d',
                'brandHaloNewToBrandSales14d',
                ])
              }}
            startDate: >-
              {%- set _start_date = config.get("start_date") -%} {%- set
              start_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} {%-
              set end_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} "{{
              start_date.strftime("%Y%m%d") if not config.get("start_date") else
              max(format_datetime(config['start_date'], "%Y%m%d"), (end_date -
              duration("P90D")).strftime("%Y%m%d")) | string }}"
            reportType: PRODUCTS
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                predicate: >-
                  {{ response.message == "This profileID is not authorized to
                  use Amazon Attribution" }}
                error_message: "{{ response }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
              - type: HttpResponseFilter
                action: IGNORE
                predicate: "{{ 'code' in response and 'details' in response }}"
                error_message: "{{ response.code }}; {{ response.details }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - reports
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: cursorId
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: count
          pagination_strategy:
            type: CursorPagination
            page_size: 300
            cursor_value: "{{ response.cursorId }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
              parent_key: profileId
              extra_fields:
                - - timezone
              partition_field: profileId
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/attribution_report_products"
    attribution_report_performance_adgroup:
      type: DeclarativeStream
      name: attribution_report_performance_adgroup
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /attribution/report
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            endDate: >-
              "{{
              format_datetime(today_with_timezone(stream_slice.extra_fields['timezone']).strftime('%Y%m%d'),
              '%Y%m%d', '%Y%m%d') }}"
            groupBy: ADGROUP
            metrics: |
              {{
                ','.join([
                'Click-throughs',
                'attributedDetailPageViewsClicks14d',
                'attributedAddToCartClicks14d',
                'attributedPurchases14d',
                'unitsSold14d',
                'attributedSales14d',
                'attributedTotalDetailPageViewsClicks14d',
                'attributedTotalAddToCartClicks14d',
                'attributedTotalPurchases14d',
                'totalUnitsSold14d',
                'totalAttributedSales14d',
                'brb_bonus_amount'
                ])
              }}
            startDate: >-
              {%- set _start_date = config.get("start_date") -%} {%- set
              start_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} {%-
              set end_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} "{{
              start_date.strftime("%Y%m%d") if not config.get("start_date") else
              max(format_datetime(config['start_date'], "%Y%m%d"), (end_date -
              duration("P90D")).strftime("%Y%m%d")) | string }}"
            reportType: PERFORMANCE
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 400
                error_message: "{{ response }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - reports
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: cursorId
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: count
          pagination_strategy:
            type: CursorPagination
            page_size: 300
            cursor_value: "{{ response.cursorId }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
              parent_key: profileId
              extra_fields:
                - - timezone
              partition_field: profileId
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/attribution_report_performance_adgroup"
    attribution_report_performance_campaign:
      type: DeclarativeStream
      name: attribution_report_performance_campaign
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /attribution/report
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            endDate: >-
              "{{
              format_datetime(today_with_timezone(stream_slice.extra_fields['timezone']).strftime('%Y%m%d'),
              '%Y%m%d', '%Y%m%d') }}"
            groupBy: CAMPAIGN
            metrics: |
              {{
                ','.join([
                'Click-throughs',
                'attributedDetailPageViewsClicks14d',
                'attributedAddToCartClicks14d',
                'attributedPurchases14d',
                'unitsSold14d',
                'attributedSales14d',
                'attributedTotalDetailPageViewsClicks14d',
                'attributedTotalAddToCartClicks14d',
                'attributedTotalPurchases14d',
                'totalUnitsSold14d',
                'totalAttributedSales14d',
                'brb_bonus_amount'
                ])
              }}
            startDate: >-
              {%- set _start_date = config.get("start_date") -%} {%- set
              start_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} {%-
              set end_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} "{{
              start_date.strftime("%Y%m%d") if not config.get("start_date") else
              max(format_datetime(config['start_date'], "%Y%m%d"), (end_date -
              duration("P90D")).strftime("%Y%m%d")) | string }}"
            reportType: PERFORMANCE
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 400
                error_message: "{{ response }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - reports
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: cursorId
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: count
          pagination_strategy:
            type: CursorPagination
            page_size: 300
            cursor_value: "{{ response.cursorId }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
              parent_key: profileId
              extra_fields:
                - - timezone
              partition_field: profileId
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/attribution_report_performance_campaign"
    attribution_report_performance_creative:
      type: DeclarativeStream
      name: attribution_report_performance_creative
      retriever:
        type: SimpleRetriever
        requester:
          $ref: "#/definitions/base_requester"
          path: /attribution/report
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            endDate: >-
              "{{
              format_datetime(today_with_timezone(stream_slice.extra_fields['timezone']).strftime('%Y%m%d'),
              '%Y%m%d', '%Y%m%d') }}"
            groupBy: CREATIVE
            metrics: |
              {{
                ','.join([
                'Click-throughs',
                'attributedDetailPageViewsClicks14d',
                'attributedAddToCartClicks14d',
                'attributedPurchases14d',
                'unitsSold14d',
                'attributedSales14d',
                'attributedTotalDetailPageViewsClicks14d',
                'attributedTotalAddToCartClicks14d',
                'attributedTotalPurchases14d',
                'totalUnitsSold14d',
                'totalAttributedSales14d',
                ])
              }}
            startDate: >-
              {%- set _start_date = config.get("start_date") -%} {%- set
              start_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} {%-
              set end_date =
              today_with_timezone(stream_slice.extra_fields["timezone"]) -%} "{{
              start_date.strftime("%Y%m%d") if not config.get("start_date") else
              max(format_datetime(config['start_date'], "%Y%m%d"), (end_date -
              duration("P90D")).strftime("%Y%m%d")) | string }}"
            reportType: PERFORMANCE
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: IGNORE
                http_codes:
                  - 400
                error_message: "{{ response }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'message' in response }}"
                error_message: "{{ response.message }}"
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path:
              - reports
        paginator:
          type: DefaultPaginator
          page_token_option:
            type: RequestOption
            inject_into: body_json
            field_name: cursorId
          page_size_option:
            type: RequestOption
            inject_into: body_json
            field_name: count
          pagination_strategy:
            type: CursorPagination
            page_size: 300
            cursor_value: "{{ response.cursorId }}"
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
              parent_key: profileId
              extra_fields:
                - - timezone
              partition_field: profileId
        decoder:
          type: JsonDecoder
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/attribution_report_performance_creative"
    sponsored_brands_v3_report_stream:
      type: DeclarativeStream
      name: sponsored_brands_v3_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: purchasedAsin report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignBudgetCurrencyCode
                - campaignName
                - adGroupName
                - attributionType
                - purchasedAsin
                - productName
                - productCategory
                - sales14d
                - orders14d
                - unitsSold14d
                - newToBrandSales14d
                - newToBrandPurchases14d
                - newToBrandUnitsSold14d
                - newToBrandSalesPercentage14d
                - newToBrandPurchasesPercentage14d
                - newToBrandUnitsSoldPercentage14d
              filters: []
              groupBy:
                - purchasedAsin
              timeUnit: SUMMARY
              adProduct: SPONSORED_BRANDS
              reportTypeId: sbPurchasedProduct
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            # TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - purchasedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_brands_v3_report_stream"
    sponsored_display_campaigns_report_stream:
      type: DeclarativeStream
      name: sponsored_display_campaigns_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: campaigns report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - endDate
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - startDate
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
                - campaignBudgetAmount
                - campaignStatus
                - costType
                - cumulativeReach
                - impressionsFrequencyAverage
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
                - newToBrandSales
              filters: []
              groupBy:
                - campaign
              timeUnit: SUMMARY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdCampaigns
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - campaignId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_campaigns_report_stream"
    sponsored_display_adgroups_report_stream:
      type: DeclarativeStream
      name: sponsored_display_adgroups_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: adGroups report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - adGroupId
                - adGroupName
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - bidOptimization
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - endDate
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - startDate
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
                - cumulativeReach
                - impressionsFrequencyAverage
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
              filters: []
              groupBy:
                - adGroup
              timeUnit: SUMMARY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdAdGroup
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              # TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adGroupId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_adgroups_report_stream"
    sponsored_display_productads_report_stream:
      type: DeclarativeStream
      name: sponsored_display_productads_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: productAds report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - addToCart
                - addToCartRate
                - addToCartViews
                - addToCartClicks
                - adGroupId
                - adGroupName
                - adId
                - addToList
                - addToListFromClicks
                - qualifiedBorrows
                - royaltyQualifiedBorrows
                - addToListFromViews
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - bidOptimization
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - cumulativeReach
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - endDate
                - impressions
                - impressionsFrequencyAverage
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - promotedAsin
                - promotedSku
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - startDate
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
              filters: []
              groupBy:
                - advertiser
              timeUnit: SUMMARY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdAdvertisedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_productads_report_stream"
    sponsored_display_targets_report_stream:
      type: DeclarativeStream
      name: sponsored_display_targets_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: targets report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - adGroupId
                - adGroupName
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - endDate
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - startDate
                - targetingExpression
                - targetingId
                - targetingText
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
              filters: []
              groupBy:
                - targeting
              timeUnit: SUMMARY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdTargeting
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - targetingId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_targets_report_stream"
    sponsored_display_asins_report_stream:
      type: DeclarativeStream
      name: sponsored_display_asins_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - adGroupId
                - adGroupName
                - asinBrandHalo
                - addToList
                - addToListFromClicks
                - qualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromViews
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - conversionsBrandHalo
                - conversionsBrandHaloClicks
                - endDate
                - promotedAsin
                - promotedSku
                - salesBrandHalo
                - salesBrandHaloClicks
                - startDate
                - unitsSoldBrandHalo
                - unitsSoldBrandHaloClicks
              filters: []
              groupBy:
                - asin
              timeUnit: SUMMARY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdPurchasedProduct
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              # TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - promotedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_asins_report_stream"
    sponsored_products_campaigns_report_stream:
      type: DeclarativeStream
      name: sponsored_products_campaigns_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: campaigns report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - campaignStatus
                - campaignBudgetAmount
                - campaignRuleBasedBudgetAmount
                - campaignApplicableBudgetRuleId
                - campaignApplicableBudgetRuleName
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - campaign
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spCampaigns
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - campaignId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_campaigns_report_stream"
    sponsored_products_adgroups_report_stream:
      type: DeclarativeStream
      name: sponsored_products_adgroups_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: adGroups report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - campaign
                - adGroup
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spCampaigns
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              # TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adGroupId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_adgroups_report_stream"
    sponsored_products_keywords_report_stream:
      type: DeclarativeStream
      name: sponsored_products_keywords_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: keywords report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - matchType
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters:
                - field: keywordType
                  values:
                    - BROAD
                    - PHRASE
                    - EXACT
              groupBy:
                - targeting
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spTargeting
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - keywordId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_keywords_report_stream"
    sponsored_products_targets_report_stream:
      type: DeclarativeStream
      name: sponsored_products_targets_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: targets report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - targeting
                - keywordType
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters:
                - field: keywordType
                  values:
                    - TARGETING_EXPRESSION
                    - TARGETING_EXPRESSION_PREDEFINED
              groupBy:
                - targeting
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spTargeting
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - keywordId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_targets_report_stream"
    sponsored_products_productads_report_stream:
      type: DeclarativeStream
      name: sponsored_products_productads_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: productAds report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - adId
                - impressions
                - clicks
                - cost
                - campaignBudgetCurrencyCode
                - advertisedAsin
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - advertiser
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spAdvertisedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_productads_report_stream"
    sponsored_products_asins_keywords_report_stream:
      type: DeclarativeStream
      name: sponsored_products_asins_keywords_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins_keywords report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - advertisedAsin
                - purchasedAsin
                - advertisedSku
                - campaignBudgetCurrencyCode
                - matchType
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - unitsSoldOtherSku1d
                - unitsSoldOtherSku7d
                - unitsSoldOtherSku14d
                - unitsSoldOtherSku30d
                - salesOtherSku1d
                - salesOtherSku7d
                - salesOtherSku14d
                - salesOtherSku30d
              filters: []
              groupBy:
                - asin
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - advertisedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_asins_keywords_report_stream"
    sponsored_products_asins_targets_report_stream:
      type: DeclarativeStream
      name: sponsored_products_asins_targets_report_stream
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins_targets report {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - advertisedAsin
                - purchasedAsin
                - advertisedSku
                - campaignBudgetCurrencyCode
                - matchType
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - unitsSoldOtherSku1d
                - unitsSoldOtherSku7d
                - unitsSoldOtherSku14d
                - unitsSoldOtherSku30d
                - salesOtherSku1d
                - salesOtherSku7d
                - salesOtherSku14d
                - salesOtherSku30d
                - keywordId
                - targeting
                - keywordType
              filters: []
              groupBy:
                - asin
              timeUnit: SUMMARY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - advertisedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_asins_targets_report_stream"
    sponsored_brands_v3_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_brands_v3_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: purchasedAsin report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignBudgetCurrencyCode
                - campaignName
                - adGroupName
                - attributionType
                - purchasedAsin
                - productName
                - productCategory
                - sales14d
                - orders14d
                - unitsSold14d
                - newToBrandSales14d
                - newToBrandPurchases14d
                - newToBrandUnitsSold14d
                - newToBrandSalesPercentage14d
                - newToBrandPurchasesPercentage14d
                - newToBrandUnitsSoldPercentage14d
              filters: []
              groupBy:
                - purchasedAsin
              timeUnit: DAILY
              adProduct: SPONSORED_BRANDS
              reportTypeId: sbPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - purchasedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_brands_v3_report_stream_daily"
    sponsored_display_campaigns_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_display_campaigns_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: campaigns report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
                - campaignBudgetAmount
                - campaignStatus
                - costType
                - cumulativeReach
                - impressionsFrequencyAverage
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
                - newToBrandSales
              filters: []
              groupBy:
                - campaign
              timeUnit: DAILY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdCampaigns
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - campaignId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_campaigns_report_stream_daily"
    sponsored_display_adgroups_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_display_adgroups_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: adGroups report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - adGroupId
                - adGroupName
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - bidOptimization
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
                - cumulativeReach
                - impressionsFrequencyAverage
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
              filters: []
              groupBy:
                - adGroup
              timeUnit: DAILY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdAdGroup
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adGroupId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_adgroups_report_stream_daily"
    sponsored_display_productads_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_display_productads_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: productAds report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - addToCart
                - addToCartRate
                - addToCartViews
                - addToCartClicks
                - adGroupId
                - adGroupName
                - adId
                - addToList
                - addToListFromClicks
                - qualifiedBorrows
                - royaltyQualifiedBorrows
                - addToListFromViews
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - bidOptimization
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - cumulativeReach
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - impressions
                - impressionsFrequencyAverage
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandDetailPageViewClicks
                - newToBrandDetailPageViewRate
                - newToBrandDetailPageViews
                - newToBrandDetailPageViewViews
                - newToBrandECPDetailPageView
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - promotedAsin
                - promotedSku
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
              filters: []
              groupBy:
                - advertiser
              timeUnit: DAILY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdAdvertisedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_productads_report_stream_daily"
    sponsored_display_targets_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_display_targets_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: targets report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - addToCart
                - addToCartClicks
                - addToCartRate
                - addToCartViews
                - adGroupId
                - adGroupName
                - addToList
                - addToListFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromClicks
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromViews
                - brandedSearches
                - brandedSearchesClicks
                - brandedSearchesViews
                - brandedSearchRate
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - clicks
                - cost
                - detailPageViews
                - detailPageViewsClicks
                - eCPAddToCart
                - eCPBrandSearch
                - impressions
                - impressionsViews
                - leadFormOpens
                - leads
                - linkOuts
                - newToBrandPurchases
                - newToBrandPurchasesClicks
                - newToBrandSales
                - newToBrandSalesClicks
                - newToBrandUnitsSold
                - newToBrandUnitsSoldClicks
                - purchases
                - purchasesClicks
                - purchasesPromotedClicks
                - sales
                - salesClicks
                - salesPromotedClicks
                - targetingExpression
                - targetingId
                - targetingText
                - unitsSold
                - unitsSoldClicks
                - videoCompleteViews
                - videoFirstQuartileViews
                - videoMidpointViews
                - videoThirdQuartileViews
                - videoUnmutes
                - viewabilityRate
                - viewClickThroughRate
              filters: []
              groupBy:
                - targeting
              timeUnit: DAILY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdTargeting
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - targetingId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_targets_report_stream_daily"
    sponsored_display_asins_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_display_asins_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - adGroupId
                - adGroupName
                - asinBrandHalo
                - addToList
                - addToListFromClicks
                - qualifiedBorrowsFromClicks
                - royaltyQualifiedBorrowsFromClicks
                - addToListFromViews
                - qualifiedBorrows
                - qualifiedBorrowsFromViews
                - royaltyQualifiedBorrows
                - royaltyQualifiedBorrowsFromViews
                - campaignBudgetCurrencyCode
                - campaignId
                - campaignName
                - conversionsBrandHalo
                - conversionsBrandHaloClicks
                - promotedAsin
                - promotedSku
                - salesBrandHalo
                - salesBrandHaloClicks
                - unitsSoldBrandHalo
                - unitsSoldBrandHaloClicks
              filters: []
              groupBy:
                - asin
              timeUnit: DAILY
              adProduct: SPONSORED_DISPLAY
              reportTypeId: sdPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - promotedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_display_asins_report_stream_daily"
    sponsored_products_campaigns_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_campaigns_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: campaigns report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - campaignStatus
                - campaignBudgetAmount
                - campaignRuleBasedBudgetAmount
                - campaignApplicableBudgetRuleId
                - campaignApplicableBudgetRuleName
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - campaign
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spCampaigns
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - campaignId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_campaigns_report_stream_daily"
    sponsored_products_adgroups_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_adgroups_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: adGroups report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - campaign
                - adGroup
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spCampaigns
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adGroupId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_adgroups_report_stream_daily"
    sponsored_products_keywords_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_keywords_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: keywords report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - matchType
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters:
                - field: keywordType
                  values:
                    - BROAD
                    - PHRASE
                    - EXACT
              groupBy:
                - targeting
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spTargeting
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - keywordId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_keywords_report_stream_daily"
    sponsored_products_targets_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_targets_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: targets report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - targeting
                - keywordType
                - impressions
                - clicks
                - cost
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters:
                - field: keywordType
                  values:
                    - TARGETING_EXPRESSION
                    - TARGETING_EXPRESSION_PREDEFINED
              groupBy:
                - targeting
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spTargeting
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - keywordId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_targets_report_stream_daily"
    sponsored_products_productads_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_productads_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: productAds report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - adId
                - impressions
                - clicks
                - cost
                - campaignBudgetCurrencyCode
                - advertisedAsin
                - purchases1d
                - purchases7d
                - purchases14d
                - purchases30d
                - purchasesSameSku1d
                - purchasesSameSku7d
                - purchasesSameSku14d
                - purchasesSameSku30d
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - sales1d
                - sales7d
                - sales14d
                - sales30d
                - attributedSalesSameSku1d
                - attributedSalesSameSku7d
                - attributedSalesSameSku14d
                - attributedSalesSameSku30d
                - unitsSoldSameSku1d
                - unitsSoldSameSku7d
                - unitsSoldSameSku14d
                - unitsSoldSameSku30d
              filters: []
              groupBy:
                - advertiser
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spAdvertisedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - adId
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_productads_report_stream_daily"
    sponsored_products_asins_keywords_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_asins_keywords_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins_keywords report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - keywordId
                - keyword
                - advertisedAsin
                - purchasedAsin
                - advertisedSku
                - campaignBudgetCurrencyCode
                - matchType
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - unitsSoldOtherSku1d
                - unitsSoldOtherSku7d
                - unitsSoldOtherSku14d
                - unitsSoldOtherSku30d
                - salesOtherSku1d
                - salesOtherSku7d
                - salesOtherSku14d
                - salesOtherSku30d
              filters: []
              groupBy:
                - asin
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - advertisedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_asins_keywords_report_stream_daily"
    sponsored_products_asins_targets_report_stream_daily:
      type: DeclarativeStream
      name: sponsored_products_asins_targets_report_stream_daily
      retriever:
        type: AsyncRetriever
        record_selector:
          type: RecordSelector
          extractor:
            type: DpathExtractor
            field_path: []
        status_mapping:
          failed:
            - FAILED
          running:
            - PENDING
            - PROCESSING
          timeout:
            - timeout
          completed:
            - COMPLETED
        status_extractor:
          type: DpathExtractor
          field_path:
            - status
        download_target_extractor:
          type: DpathExtractor
          field_path:
            - url
        partition_router:
          type: SubstreamPartitionRouter
          parent_stream_configs:
            - type: ParentStreamConfig
              parent_key: profileId
              partition_field: profileId
              stream:
                $ref: "#/definitions/streams/profiles_filtered"
        decoder:
          type: JsonDecoder
        creation_requester:
          type: HttpRequester
          url_base: |-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: POST
          request_headers:
            Amazon-Advertising-API-Scope: "{{ stream_partition['profileId'] }}"
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          request_body_json:
            name: asins_targets report daily {{ stream_interval.start_time }}
            endDate: "{{ stream_interval.end_time }}"
            startDate: >
              {% if stream_interval.start_time < config['start_date'] %}
                {{ config['start_date'] }}
              {% else %}
                {{ stream_interval.start_time }}
              {% endif %}
            configuration:
              format: GZIP_JSON
              columns:
                - date
                - campaignName
                - campaignId
                - adGroupName
                - adGroupId
                - advertisedAsin
                - purchasedAsin
                - advertisedSku
                - campaignBudgetCurrencyCode
                - matchType
                - unitsSoldClicks1d
                - unitsSoldClicks7d
                - unitsSoldClicks14d
                - unitsSoldClicks30d
                - unitsSoldOtherSku1d
                - unitsSoldOtherSku7d
                - unitsSoldOtherSku14d
                - unitsSoldOtherSku30d
                - salesOtherSku1d
                - salesOtherSku7d
                - salesOtherSku14d
                - salesOtherSku30d
                - keywordId
                - targeting
                - keywordType
              filters: []
              groupBy:
                - asin
              timeUnit: DAILY
              adProduct: SPONSORED_PRODUCTS
              reportTypeId: spPurchasedProduct
            TODO Fix me: The creation_response interpolation context should be available directly in the headers.
            # https://github.com/airbytehq/airbyte/pull/55806#issuecomment-2734493924
          error_handler:
            type: DefaultErrorHandler
            response_filters:
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'KDP authors do not have access to Sponsored Brands
                  functionality' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Not authorized to access scope' in response.details }}"
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: >-
                  {{ 'Tactic T00020 is not supported for report API in
                  marketplace' in response.details }}
                error_message: "{{ response.details }}"
              - type: HttpResponseFilter
                action: FAIL
                predicate: "{{ 'Report date is too far in the past' in response.details }}"
                error_message: "{{ response.details }}"
        polling_requester:
          type: HttpRequester
          url_base: >-
            {%- set URL_MAPPING = {
                "NA": "https://advertising-api.amazon.com/",
                "EU": "https://advertising-api-eu.amazon.com/",
                "FE": "https://advertising-api-fe.amazon.com/"
            } -%} {{ URL_MAPPING[config["region"]] }}/reporting/reports/{{
            creation_response['reportId'] }}
          authenticator:
            type: OAuthAuthenticator
            client_id: "{{ config[\"client_id\"] }}"
            grant_type: refresh_token
            client_secret: "{{ config[\"client_secret\"] }}"
            refresh_token: "{{ config[\"refresh_token\"] }}"
            refresh_request_body: {}
            token_refresh_endpoint: https://api.amazon.com/auth/o2/token
          http_method: GET
          request_headers:
            Amazon-Advertising-API-Scope: >-
              {{
              stream_slice.extra_fields['creation_response'].request.headers['Amazon-Advertising-API-Scope']
              }}
            Amazon-Advertising-API-ClientId: "{{ config[\"client_id\"] }}"
          error_handler:
            type: CompositeErrorHandler
            error_handlers:
              - type: DefaultErrorHandler
                max_retries: 5
                response_filters:
                  - type: HttpResponseFilter
                    action: RETRY
                    http_codes:
                      - 401
                    error_message: >-
                      Unauthorized error while report status checking. Known
                      error. Please, retry the request or restart sync.
        download_requester:
          type: HttpRequester
          url_base: {{ download_target }}
          http_method: GET
        download_decoder:
          # TODO Fix me: Add default content type as "gzip" for GzipDecoder on python-cdk.
          # https://github.com/airbytehq/airbyte/issues/56988
          type: GzipDecoder
          decoder:
            type: GzipDecoder
            decoder:
              type: JsonDecoder
      primary_key:
        - profileId
        - reportDate
        - adGroupName
        - advertisedAsin
      incremental_sync:
        type: DatetimeBasedCursor
        cursor_field: reportDate
        lookback_window: P{{ config.get('look_back_window', 3) }}D
        cursor_datetime_formats:
          - "%Y-%m-%d"
        datetime_format: "%Y-%m-%d"
        start_datetime:
          type: MinMaxDatetime
          datetime: >-
            {%- set today = today_utc() - duration('P1D') -%} {%- set
            user_start_date = config.get('start_date',
            today.strftime('%Y-%m-%d')) -%} {%- set ninety_days_ago = today -
            duration('P90D') -%} "{{ max(user_start_date,
            ninety_days_ago.strftime('%Y-%m-%d')) }}"
          datetime_format: "%Y-%m-%d"
        start_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: startDate
        end_time_option:
          type: RequestOption
          inject_into: body_json
          field_name: endDate
        end_datetime:
          type: MinMaxDatetime
          datetime: "{{ today_utc() }}"
          datetime_format: "%Y-%m-%d"
        step: P{{ config.get('events_time_step', 30) }}D
        cursor_granularity: P1D
      transformations:
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - reportDate
              value: "{{ stream_interval.end_time }}"
        - type: AddFields
          fields:
            - type: AddedFieldDefinition
              path:
                - profileId
              value: "{{ stream_partition['profileId'] }}"
      schema_loader:
        type: InlineSchemaLoader
        schema:
          $ref: "#/schemas/sponsored_products_asins_targets_report_stream_daily"
  base_requester:
    type: HttpRequester
    url_base: |-
      {%- set URL_MAPPING = {
          "NA": "https://advertising-api.amazon.com/",
          "EU": "https://advertising-api-eu.amazon.com/",
          "FE": "https://advertising-api-fe.amazon.com/"
      } -%} {{ URL_MAPPING[config["region"]] }}
    authenticator:
      type: OAuthAuthenticator
      client_id: "{{ config[\"client_id\"] }}"
      grant_type: refresh_token
      client_secret: "{{ config[\"client_secret\"] }}"
      refresh_token: "{{ config[\"refresh_token\"] }}"
      refresh_request_body: {}
      token_refresh_endpoint: https://api.amazon.com/auth/o2/token

streams:
  - $ref: "#/definitions/streams/profiles"
  - $ref: "#/definitions/streams/portfolios"
  - $ref: "#/definitions/streams/sponsored_display_campaigns"
  - $ref: "#/definitions/streams/sponsored_display_ad_groups"
  - $ref: "#/definitions/streams/sponsored_display_product_ads"
  - $ref: "#/definitions/streams/sponsored_display_targetings"
  - $ref: "#/definitions/streams/sponsored_display_creatives"
  - $ref: "#/definitions/streams/sponsored_display_budget_rules"
  - $ref: "#/definitions/streams/sponsored_brands_keywords"
  - $ref: "#/definitions/streams/sponsored_brands_campaigns"
  - $ref: "#/definitions/streams/sponsored_brands_ad_groups"
  - $ref: "#/definitions/streams/sponsored_product_campaigns"
  - $ref: "#/definitions/streams/sponsored_product_ad_groups"
  - $ref: "#/definitions/streams/sponsored_product_keywords"
  - $ref: "#/definitions/streams/sponsored_product_negative_keywords"
  - $ref: "#/definitions/streams/sponsored_product_campaign_negative_keywords"
  - $ref: "#/definitions/streams/sponsored_product_ads"
  - $ref: "#/definitions/streams/sponsored_product_targetings"
  - $ref: "#/definitions/streams/sponsored_product_ad_group_bid_recommendations"
  - $ref: "#/definitions/streams/sponsored_product_ad_group_suggested_keywords"
  - $ref: "#/definitions/streams/attribution_report_products"
  - $ref: "#/definitions/streams/attribution_report_performance_adgroup"
  - $ref: "#/definitions/streams/attribution_report_performance_campaign"
  - $ref: "#/definitions/streams/attribution_report_performance_creative"
  - $ref: "#/definitions/streams/sponsored_brands_v3_report_stream"
  - $ref: "#/definitions/streams/sponsored_display_campaigns_report_stream"
  - $ref: "#/definitions/streams/sponsored_display_adgroups_report_stream"
  - $ref: "#/definitions/streams/sponsored_display_productads_report_stream"
  - $ref: "#/definitions/streams/sponsored_display_targets_report_stream"
  - $ref: "#/definitions/streams/sponsored_display_asins_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_campaigns_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_adgroups_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_keywords_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_targets_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_productads_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_asins_keywords_report_stream"
  - $ref: "#/definitions/streams/sponsored_products_asins_targets_report_stream"
  - $ref: "#/definitions/streams/sponsored_brands_v3_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_display_campaigns_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_display_adgroups_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_display_productads_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_display_targets_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_display_asins_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_campaigns_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_adgroups_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_keywords_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_targets_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_productads_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_asins_keywords_report_stream_daily"
  - $ref: "#/definitions/streams/sponsored_products_asins_targets_report_stream_daily"

spec:
  type: Spec
  connection_specification:
    type: object
    $schema: http://json-schema.org/draft-07/schema#
    required:
      - client_id
      - client_secret
      - refresh_token
    properties:
      auth_type:
        type: string
        const: oauth2.0
        order: 0
        title: Auth Type
        default: oauth2.0
      client_id:
        type: string
        description: >-
          The client ID of your Amazon Ads developer application. See the <a
          href="https://advertising.amazon.com/API/docs/en-us/get-started/generate-api-tokens#retrieve-your-client-id-and-client-secret">docs</a>
          for more information.
        order: 1
        title: Client ID
        airbyte_secret: true
      client_secret:
        type: string
        description: >-
          The client secret of your Amazon Ads developer application. See the <a
          href="https://advertising.amazon.com/API/docs/en-us/get-started/generate-api-tokens#retrieve-your-client-id-and-client-secret">docs</a>
          for more information.
        order: 2
        title: Client Secret
        airbyte_secret: true
      refresh_token:
        type: string
        description: >-
          Amazon Ads refresh token. See the <a
          href="https://advertising.amazon.com/API/docs/en-us/get-started/generate-api-tokens">docs</a>
          for more information on how to obtain this token.
        order: 3
        title: Refresh Token
        airbyte_secret: true
      region:
        type: string
        description: >-
          Region to pull data from (EU/NA/FE). See <a
          href="https://advertising.amazon.com/API/docs/en-us/info/api-overview#api-endpoints">docs</a>
          for more details.
        enum:
          - NA
          - EU
          - FE
        order: 4
        title: Region
        default: NA
      start_date:
        type: string
        description: >-
          The Start date for collecting reports, should not be more than 60 days
          in the past. In YYYY-MM-DD format
        order: 5
        title: Start Date
        format: date
        pattern: ^[0-9]{4}-[0-9]{2}-[0-9]{2}$
        examples:
          - "2022-10-10"
          - "2022-10-22"
      profiles:
        type: array
        description: >-
          Profile IDs you want to fetch data for. The Amazon Ads source
          connector supports only profiles with seller and vendor type, profiles
          with agency type will be ignored. See <a
          href="https://advertising.amazon.com/API/docs/en-us/concepts/authorization/profiles">docs</a>
          for more details. Note: If Marketplace IDs are also selected, profiles
          will be selected if they match the Profile ID OR the Marketplace ID.
        items:
          type: integer
        order: 6
        title: Profile IDs
      marketplace_ids:
        type: array
        description: >-
          Marketplace IDs you want to fetch data for. Note: If Profile IDs are
          also selected, profiles will be selected if they match the Profile ID
          OR the Marketplace ID.
        items:
          type: string
        order: 7
        title: Marketplace IDs
      state_filter:
        type: array
        description: >-
          Reflects the state of the Display, Product, and Brand Campaign streams
          as enabled, paused, or archived. If you do not populate this field, it
          will be ignored completely.
        items:
          type: string
          description: An enumeration.
          enum:
            - enabled
            - paused
            - archived
          title: StateFilterEnum
        order: 8
        title: State Filter
        default: []
        uniqueItems: true
      look_back_window:
        type: integer
        description: >-
          The amount of days to go back in time to get the updated data from
          Amazon Ads
        order: 9
        title: Look Back Window
        default: 3
        examples:
          - 3
          - 10
      report_record_types:
        type: array
        description: >-
          Optional configuration which accepts an array of string of record
          types. Leave blank for default behaviour to pull all report types. Use
          this config option only if you want to pull specific report type(s).
          See <a
          href="https://advertising.amazon.com/API/docs/en-us/reporting/v2/report-types">docs</a>
          for more details
        items:
          type: string
          description: An enumeration.
          enum:
            - adGroups
            - asins
            - asins_keywords
            - asins_targets
            - campaigns
            - keywords
            - productAds
            - targets
          title: ReportRecordTypeEnum
        order: 10
        title: Report Record Types
        default: []
        uniqueItems: true
    additionalProperties: true
  supportsNormalization: false
  supportsDBT: false
  advanced_auth:
    auth_flow_type: oauth2.0
    predicate_key:
    - auth_type
    predicate_value: oauth2.0
    oauth_config_specification:
      oauth_user_input_from_connector_config_specification:
        type: object
        additionalProperties: false
        properties:
          region:
            type: string
            path_in_connector_config:
            - region
      complete_oauth_output_specification:
        type: object
        additionalProperties: true
        properties:
          refresh_token:
            type: string
            path_in_connector_config:
            - refresh_token
      complete_oauth_server_input_specification:
        type: object
        additionalProperties: true
        properties:
          client_id:
            type: string
          client_secret:
            type: string
      complete_oauth_server_output_specification:
        type: object
        additionalProperties: true
        properties:
          client_id:
            type: string
            path_in_connector_config:
            - client_id
          client_secret:
            type: string
            path_in_connector_config:
            - client_secret

metadata:
  assist: {}
  testedStreams:
    profiles:
      streamHash: 5bcf60ed019768f598ab1b41ab9ec59c46b6a564
    portfolios:
      streamHash: b01793f483774f1acc92344ee6928117de616a14
    sponsored_product_ads:
      streamHash: 3dc5dc701d5f3e3f0d0a397b344e03478909e3ec
    sponsored_brands_keywords:
      streamHash: 90e4d8bb242d08bc71197ea50d34c6e24d16f9c5
    sponsored_brands_ad_groups:
      streamHash: 9c01870a4178160cc30cfbcaf377e9ed195aa7a4
    sponsored_brands_campaigns:
      streamHash: 8a551f3355b86728cedec91b929ce8f0aa28a3e5
    sponsored_product_keywords:
      streamHash: 1f420353b856aece6e9271b4432e5cefa527e4a8
    attribution_report_products:
      streamHash: bc35301d9d26f7eeee26e39be91a204da7c6da5a
    sponsored_display_ad_groups:
      streamHash: d1d12d0c6e71f29fa98cb4a6730ba1a7f0b35461
    sponsored_display_campaigns:
      streamHash: d292f14f778613d6426f0164de6f4ad285c2f6c4
    sponsored_display_creatives:
      streamHash: 2b580047be740b00fbeb5c0cac1294b805ae8a81
    sponsored_product_ad_groups:
      streamHash: 4fa49b1748d820f493bb9c23a99a7d680ddf4762
    sponsored_product_campaigns:
      streamHash: 99068757f625f261c58c6227f59707f014c8c10a
    sponsored_display_targetings:
      streamHash: 9084f7a290ec26c239b53d878d6c243a65f2fee9
    sponsored_product_targetings:
      streamHash: 8ef8e8736bbf0e94545b0600180e5f9cedd15036
    sponsored_display_product_ads:
      streamHash: 26c8d5d6342e30f3ee9f0a26d897b8fa4972f49b
    sponsored_display_budget_rules:
      streamHash: b782ce0a96580b232f871f7457eadfc28b9d2274
    sponsored_brands_v3_report_stream:
      streamHash: cfd098d9faf1935eeac98ba0a22f7e912117fa16
    sponsored_product_negative_keywords:
      streamHash: 30ced0db3e512825f5670a3680c7cdc1f0a6c340
    sponsored_display_asins_report_stream:
      streamHash: 22ceeb55572279f9bb9173876b7b1d45ae4fe944
    attribution_report_performance_adgroup:
      streamHash: a0e6ae84006d16c64432fa00e2b7a1b6487e0103
    attribution_report_performance_campaign:
      streamHash: 54cbc96663eb04eb06700c327d5ce57069dcafde
    attribution_report_performance_creative:
      streamHash: 68fccaab11defb92c96901e738741a316c48f884
    sponsored_brands_v3_report_stream_daily:
      streamHash: a604da6e71ff5f5db311b2895f7bed21362a12d2
    sponsored_display_targets_report_stream:
      streamHash: 5f374ec4911d9c9f04ef06144e91d0ccd3f8e16a
    sponsored_display_adgroups_report_stream:
      streamHash: b6bce7ee17dabdfb93ec35a5d11122385e10efe3
    sponsored_products_targets_report_stream:
      streamHash: a02efe2233a5f9b3469898b9bb1107c0b1786a97
    sponsored_display_campaigns_report_stream:
      streamHash: f8382a89eeba528030c716b3ee7cf924a4d2742c
    sponsored_products_adgroups_report_stream:
      streamHash: 81624dfee77167102b9ea88e58986e713f633103
    sponsored_products_keywords_report_stream:
      streamHash: 69a6e6639d51592e3b0e8e4078b53f186289715c
    sponsored_display_productads_report_stream:
      streamHash: 7359419cf0f14945796a03527c9d4faea94e54c2
    sponsored_products_campaigns_report_stream:
      streamHash: 7aab46f99a43cc78d6df58bf06d76cfe4216d9c7
    sponsored_display_asins_report_stream_daily:
      streamHash: b0f0ee19f48f7350ca46d4c49547f955e14cf6c5
    sponsored_products_productads_report_stream:
      streamHash: 776e162325d1c350e7d0dcc03943577643552f15
    sponsored_product_campaign_negative_keywords:
      streamHash: 02f3a03e3d1a61da6c8294b09742d678af4e5035
    sponsored_display_targets_report_stream_daily:
      streamHash: b0bf742d6aeab91c11ad9bd9ab5463bb840c32fe
    sponsored_product_ad_group_suggested_keywords:
      streamHash: 01e0e45cb6d37fd2e924f11d43cf4b4a05c261d5
    sponsored_display_adgroups_report_stream_daily:
      streamHash: eed13ecb216ccaeafbb657de9d4f9532583784f7
    sponsored_product_ad_group_bid_recommendations:
      streamHash: 71f498d54acd2a708228e13559882a8034048d92
    sponsored_products_asins_targets_report_stream:
      streamHash: 36622d3dda4dedaec8d3ff77324148443b76c79a
    sponsored_products_targets_report_stream_daily:
      streamHash: 8a3c1bb06092f5bf64ab3566b22c2c22b92589da
    sponsored_display_campaigns_report_stream_daily:
      streamHash: 2f6c5a779f1cb4dd430321a638417f15012916c6
    sponsored_products_adgroups_report_stream_daily:
      streamHash: 6290ea0d28491306dcdc7b47a0b3d6f4abc2618b
    sponsored_products_asins_keywords_report_stream:
      streamHash: ea1e904f0eba6b028cd5b68fe53c849605033c07
    sponsored_products_keywords_report_stream_daily:
      streamHash: 4ee16d2a24b03c264b7f1dd900d1e7e8392ca281
    sponsored_display_productads_report_stream_daily:
      streamHash: 348ee25f54706c2b5d8f2a35cb3ee9ada347f85b
    sponsored_products_campaigns_report_stream_daily:
      streamHash: 1b3cc9814a8d841d8c608a5e6579aaddb2b8168f
    sponsored_products_productads_report_stream_daily:
      streamHash: 7b984c803bdbba0421d38caab898cadc4d21b9e5
    sponsored_products_asins_targets_report_stream_daily:
      streamHash: 9e008fa134929d190880beb78e133251d808691b
    sponsored_products_asins_keywords_report_stream_daily:
      streamHash: 4b8da8e740d1d9eab8add3dbba4fda6efd80f58d
  autoImportSchema:
    profiles: false
    portfolios: false
    sponsored_product_ads: false
    sponsored_brands_keywords: false
    sponsored_brands_ad_groups: false
    sponsored_brands_campaigns: false
    sponsored_product_keywords: false
    attribution_report_products: false
    sponsored_display_ad_groups: false
    sponsored_display_campaigns: false
    sponsored_display_creatives: false
    sponsored_product_ad_groups: false
    sponsored_product_campaigns: false
    sponsored_display_targetings: false
    sponsored_product_targetings: false
    sponsored_display_product_ads: false
    sponsored_display_budget_rules: false
    sponsored_brands_v3_report_stream: false
    sponsored_product_negative_keywords: false
    sponsored_display_asins_report_stream: false
    attribution_report_performance_adgroup: false
    attribution_report_performance_campaign: false
    attribution_report_performance_creative: false
    sponsored_brands_v3_report_stream_daily: false
    sponsored_display_targets_report_stream: false
    sponsored_display_adgroups_report_stream: false
    sponsored_products_targets_report_stream: false
    sponsored_display_campaigns_report_stream: false
    sponsored_products_adgroups_report_stream: false
    sponsored_products_keywords_report_stream: false
    sponsored_display_productads_report_stream: false
    sponsored_products_campaigns_report_stream: false
    sponsored_display_asins_report_stream_daily: false
    sponsored_products_productads_report_stream: false
    sponsored_product_campaign_negative_keywords: false
    sponsored_display_targets_report_stream_daily: false
    sponsored_product_ad_group_suggested_keywords: false
    sponsored_display_adgroups_report_stream_daily: false
    sponsored_product_ad_group_bid_recommendations: false
    sponsored_products_asins_targets_report_stream: false
    sponsored_products_targets_report_stream_daily: false
    sponsored_display_campaigns_report_stream_daily: false
    sponsored_products_adgroups_report_stream_daily: false
    sponsored_products_asins_keywords_report_stream: false
    sponsored_products_keywords_report_stream_daily: false
    sponsored_display_productads_report_stream_daily: false
    sponsored_products_campaigns_report_stream_daily: false
    sponsored_products_productads_report_stream_daily: false
    sponsored_products_asins_targets_report_stream_daily: false
    sponsored_products_asins_keywords_report_stream_daily: false

schemas:
  profiles:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      countryCode:
        type:
          - "null"
          - string
      currencyCode:
        type:
          - "null"
          - string
      dailyBudget:
        type:
          - "null"
          - number
      timezone:
        type:
          - "null"
          - string
      accountInfo:
        type:
          - object
          - "null"
        properties:
          type:
            type:
              - "null"
              - string
          marketplaceStringId:
            type:
              - "null"
              - string
          id:
            type:
              - "null"
              - string
          name:
            type:
              - "null"
              - string
          subType:
            type:
              - "null"
              - string
          validPaymentMethod:
            type:
              - "null"
              - boolean
    title: profiles
    additionalProperties: true
  profiles_filtered:
    type: object
    $schema: http://json-schema.org/draft-07/schema#
    additionalProperties: true
    properties: {}
  portfolios:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      portfolioId:
        type:
          - "null"
          - integer
      name:
        type:
          - "null"
          - string
      budget:
        type:
          - object
          - "null"
        properties:
          amount:
            type:
              - "null"
              - number
          currencyCode:
            type:
              - "null"
              - string
          policy:
            type:
              - "null"
              - string
          startDate:
            type:
              - "null"
              - string
          endDate:
            type:
              - "null"
              - string
      inBudget:
        type:
          - "null"
          - boolean
      state:
        type:
          - "null"
          - string
      creationDate:
        type:
          - "null"
          - integer
      lastUpdatedDate:
        type:
          - "null"
          - integer
      servingStatus:
        type:
          - "null"
          - string
    title: portfolios
    additionalProperties: true
  sponsored_display_campaigns:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      campaignId:
        type:
          - "null"
          - number
      name:
        type:
          - "null"
          - string
      budgetType:
        type:
          - "null"
          - string
      budget:
        type:
          - "null"
          - number
      startDate:
        type:
          - "null"
          - string
      endDate:
        type:
          - "null"
          - string
      costType:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      portfolioId:
        type:
          - "null"
          - integer
      tactic:
        type:
          - "null"
          - string
      deliveryProfile:
        type:
          - "null"
          - string
    title: sponsored_display_campaigns
    additionalProperties: true
  sponsored_display_ad_groups:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      name:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - number
      adGroupId:
        type:
          - "null"
          - number
      defaultBid:
        type:
          - "null"
          - number
      bidOptimization:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      tactic:
        type:
          - "null"
          - string
      creativeType:
        type:
          - "null"
          - string
    title: sponsored_display_ad_groups
    additionalProperties: true
  sponsored_display_product_ads:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      state:
        type:
          - "null"
          - string
      adId:
        type:
          - "null"
          - number
      campaignId:
        type:
          - "null"
          - number
      adGroupId:
        type:
          - "null"
          - number
      asin:
        type:
          - "null"
          - string
      sku:
        type:
          - "null"
          - string
    title: sponsored_display_product_ads
    additionalProperties: true
  sponsored_display_targetings:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      targetId:
        type:
          - "null"
          - number
      adGroupId:
        type:
          - "null"
          - number
      state:
        type:
          - "null"
          - string
      expressionType:
        type:
          - "null"
          - string
      bid:
        type:
          - "null"
          - number
      campaignId:
        type:
          - "null"
          - number
      expression:
        type: array
        items:
          type:
            - "null"
            - object
          additionalProperties: true
      resolvedExpression:
        type: array
        items:
          type:
            - "null"
            - object
          additionalProperties: true
    title: sponsored_display_targetings
    additionalProperties: true
  sponsored_display_creatives:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      adGroupId:
        type:
          - "null"
          - number
      creativeId:
        type:
          - "null"
          - number
      creativeType:
        type:
          - "null"
          - string
      properties:
        type:
          - "null"
          - object
      moderationStatus:
        type:
          - "null"
          - string
    title: sponsored_display_creatives
    additionalProperties: true
  sponsored_display_budget_rules:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      ruleId:
        type:
          - "null"
          - string
      ruleStatus:
        type:
          - "null"
          - string
      ruleState:
        type:
          - "null"
          - string
      lastUpdatedDate:
        type:
          - "null"
          - number
      createdDate:
        type:
          - "null"
          - number
      ruleDetails:
        type:
          - object
          - "null"
        properties:
          name:
            type:
              - "null"
              - string
          ruleType:
            type:
              - "null"
              - string
          duration:
            type:
              - object
              - "null"
            properties:
              eventTypeRuleDuration:
                type:
                  - object
                  - "null"
                properties:
                  eventId:
                    type:
                      - "null"
                      - string
                  endDate:
                    type:
                      - "null"
                      - string
                  eventName:
                    type:
                      - "null"
                      - string
                  startDate:
                    type:
                      - "null"
                      - string
              dateRangeTypeRuleDuration:
                type:
                  - object
                  - "null"
                properties:
                  endDate:
                    type:
                      - "null"
                      - string
                  startDate:
                    type:
                      - "null"
                      - string
          budgetIncreaseBy:
            type:
              - object
              - "null"
            properties:
              type:
                type:
                  - "null"
                  - string
              value:
                type:
                  - "null"
                  - number
          recurrence:
            type:
              - object
              - "null"
            properties:
              type:
                type:
                  - "null"
                  - string
              daysOfWeek:
                type:
                  - "null"
                  - array
                items:
                  type:
                    - "null"
                    - string
              intraDaySchedule:
                type:
                  - "null"
                  - array
                items:
                  type:
                    - object
                    - "null"
                  properties:
                    startTime:
                      type:
                        - "null"
                        - string
                    endTime:
                      type:
                        - "null"
                        - string
              threshold:
                type:
                  - "null"
                  - number
          performanceMeasureCondition:
            type:
              - object
              - "null"
            properties:
              metricName:
                type:
                  - "null"
                  - string
              comparisonOperator:
                type:
                  - "null"
                  - string
              threshold:
                type:
                  - "null"
                  - number
      ruleStatusDetails:
        type:
          - "null"
          - object
        additionalProperties: true
    title: sponsored_display_budget_rules
    additionalProperties: true
  sponsored_brands_keywords:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      campaignId:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      name:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_brands_keywords
    additionalProperties: true
  sponsored_brands_campaigns:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      campaignId:
        type:
          - "null"
          - string
      name:
        type:
          - "null"
          - string
      tags:
        type:
          - "null"
          - object
        additionalProperties: true
      budget:
        type:
          - "null"
          - number
      budgetType:
        type:
          - "null"
          - string
      startDate:
        type:
          - "null"
          - string
      endDate:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      brandEntityId:
        type:
          - "null"
          - string
      portfolioId:
        type:
          - "null"
          - string
      ruleBasedBudget:
        type:
          - "null"
          - object
      bidding:
        type:
          - "null"
          - object
      productLocation:
        type:
          - "null"
          - string
      costType:
        type:
          - "null"
          - string
      smartDefault:
        type:
          - "null"
          - array
        items:
          type:
            - "null"
            - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_brands_campaigns
    additionalProperties: true
  sponsored_brands_ad_groups:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      campaignId:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      name:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_brands_ad_groups
    additionalProperties: true
  sponsored_product_campaigns:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      portfolioId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      name:
        type:
          - "null"
          - string
      tags:
        type:
          - "null"
          - object
        additionalProperties: true
      targetingType:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      dynamicBidding:
        type:
          - "null"
          - object
      startDate:
        type:
          - "null"
          - string
      endDate:
        type:
          - "null"
          - string
      budget:
        type:
          - "null"
          - object
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_campaigns
    additionalProperties: true
  sponsored_product_ad_groups:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      adGroupId:
        type:
          - "null"
          - string
      name:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      defaultBid:
        type:
          - "null"
          - number
      state:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_ad_groups
    additionalProperties: true
  sponsored_product_keywords:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      keywordId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      keywordText:
        type:
          - "null"
          - string
      nativeLanguageLocale:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_keywords
    additionalProperties: true
  sponsored_product_negative_keywords:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      keywordId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      keywordText:
        type:
          - "null"
          - string
      nativeLanguageLocale:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_negative_keywords
    additionalProperties: true
  sponsored_product_campaign_negative_keywords:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      keywordId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - number
      state:
        type:
          - "null"
          - string
      keywordText:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_campaign_negative_keywords
    additionalProperties: true
  sponsored_product_ads:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      adId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      customText:
        type:
          - "null"
          - string
      asin:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      sku:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_ads
    additionalProperties: true
  sponsored_product_targetings:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      expression:
        type:
          - "null"
          - array
        items:
          type:
            - "null"
            - object
          additionalProperties: true
      targetId:
        type:
          - "null"
          - string
      resolvedExpression:
        type: array
        items:
          type:
            - "null"
            - object
          additionalProperties: true
      campaignId:
        type:
          - "null"
          - string
      expressionType:
        type:
          - "null"
          - string
      state:
        type:
          - "null"
          - string
      bid:
        type:
          - "null"
          - number
      adGroupId:
        type:
          - "null"
          - string
      extendedData:
        type:
          - "null"
          - object
    title: sponsored_product_targetings
    additionalProperties: true
  sponsored_product_ad_group_bid_recommendations:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      adGroupId:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      theme:
        type:
          - "null"
          - string
      bidRecommendationsForTargetingExpressions:
        type: array
        items:
          type:
            - object
            - "null"
          properties:
            bidValues:
              type: array
              items:
                type:
                  - "null"
                  - object
                additionalProperties: true
            targetingExpression:
              type:
                - "null"
                - object
              additionalProperties: true
    title: sponsored_product_ad_group_bid_recommendations
    additionalProperties: true
  sponsored_product_ad_group_suggested_keywords:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      adGroupId:
        type:
          - "null"
          - integer
      suggestedKeywords:
        type:
          - "null"
          - array
        items:
          type:
            - object
            - "null"
          properties:
            keywordText:
              type:
                - "null"
                - string
            matchType:
              type:
                - "null"
                - string
    title: sponsored_product_ad_group_suggested_keywords
    additionalProperties: true
  attribution_report_products:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      brandName:
        type:
          - "null"
          - string
      marketplace:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      productAsin:
        type:
          - "null"
          - string
      productConversionType:
        type:
          - "null"
          - string
      advertiserName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      creativeId:
        type:
          - "null"
          - string
      productName:
        type:
          - "null"
          - string
      productCategory:
        type:
          - "null"
          - string
      productSubcategory:
        type:
          - "null"
          - string
      productGroup:
        type:
          - "null"
          - string
      publisher:
        type:
          - "null"
          - string
      Click-throughs:
        type:
          - "null"
          - string
      attributedDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedPurchases14d:
        type:
          - "null"
          - string
      unitsSold14d:
        type:
          - "null"
          - string
      attributedSales14d:
        type:
          - "null"
          - string
      attributedTotalDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedTotalAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedTotalPurchases14d:
        type:
          - "null"
          - string
      totalUnitsSold14d:
        type:
          - "null"
          - string
      totalAttributedSales14d:
        type:
          - "null"
          - string
      brb_bonus_amount:
        type:
          - "null"
          - string
      brandHaloDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedAddToCartClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedPurchases14d:
        type:
          - "null"
          - string
      brandHaloUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloAttributedSales14d:
        type:
          - "null"
          - string
      attributedNewToBrandPurchases14d:
        type:
          - "null"
          - string
      attributedNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      attributedNewToBrandSales14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandPurchases14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandSales14d:
        type:
          - "null"
          - string
    title: attribution_report_products
    additionalProperties: true
  attribution_report_performance_adgroup:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      brandName:
        type:
          - "null"
          - string
      marketplace:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      productAsin:
        type:
          - "null"
          - string
      productConversionType:
        type:
          - "null"
          - string
      advertiserName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      creativeId:
        type:
          - "null"
          - string
      productName:
        type:
          - "null"
          - string
      productCategory:
        type:
          - "null"
          - string
      productSubcategory:
        type:
          - "null"
          - string
      productGroup:
        type:
          - "null"
          - string
      publisher:
        type:
          - "null"
          - string
      Click-throughs:
        type:
          - "null"
          - string
      attributedDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedPurchases14d:
        type:
          - "null"
          - string
      unitsSold14d:
        type:
          - "null"
          - string
      attributedSales14d:
        type:
          - "null"
          - string
      attributedTotalDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedTotalAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedTotalPurchases14d:
        type:
          - "null"
          - string
      totalUnitsSold14d:
        type:
          - "null"
          - string
      totalAttributedSales14d:
        type:
          - "null"
          - string
      brb_bonus_amount:
        type:
          - "null"
          - string
      brandHaloDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedAddToCartClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedPurchases14d:
        type:
          - "null"
          - string
      brandHaloUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloAttributedSales14d:
        type:
          - "null"
          - string
      attributedNewToBrandPurchases14d:
        type:
          - "null"
          - string
      attributedNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      attributedNewToBrandSales14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandPurchases14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandSales14d:
        type:
          - "null"
          - string
    title: attribution_report_performance_adgroup
    additionalProperties: true
  attribution_report_performance_campaign:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      brandName:
        type:
          - "null"
          - string
      marketplace:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      productAsin:
        type:
          - "null"
          - string
      productConversionType:
        type:
          - "null"
          - string
      advertiserName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      creativeId:
        type:
          - "null"
          - string
      productName:
        type:
          - "null"
          - string
      productCategory:
        type:
          - "null"
          - string
      productSubcategory:
        type:
          - "null"
          - string
      productGroup:
        type:
          - "null"
          - string
      publisher:
        type:
          - "null"
          - string
      Click-throughs:
        type:
          - "null"
          - string
      attributedDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedPurchases14d:
        type:
          - "null"
          - string
      unitsSold14d:
        type:
          - "null"
          - string
      attributedSales14d:
        type:
          - "null"
          - string
      attributedTotalDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedTotalAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedTotalPurchases14d:
        type:
          - "null"
          - string
      totalUnitsSold14d:
        type:
          - "null"
          - string
      totalAttributedSales14d:
        type:
          - "null"
          - string
      brb_bonus_amount:
        type:
          - "null"
          - string
      brandHaloDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedAddToCartClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedPurchases14d:
        type:
          - "null"
          - string
      brandHaloUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloAttributedSales14d:
        type:
          - "null"
          - string
      attributedNewToBrandPurchases14d:
        type:
          - "null"
          - string
      attributedNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      attributedNewToBrandSales14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandPurchases14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandSales14d:
        type:
          - "null"
          - string
    title: attribution_report_performance_campaign
    additionalProperties: true
  attribution_report_performance_creative:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      brandName:
        type:
          - "null"
          - string
      marketplace:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - string
      productAsin:
        type:
          - "null"
          - string
      productConversionType:
        type:
          - "null"
          - string
      advertiserName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - string
      creativeId:
        type:
          - "null"
          - string
      productName:
        type:
          - "null"
          - string
      productCategory:
        type:
          - "null"
          - string
      productSubcategory:
        type:
          - "null"
          - string
      productGroup:
        type:
          - "null"
          - string
      publisher:
        type:
          - "null"
          - string
      Click-throughs:
        type:
          - "null"
          - string
      attributedDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedPurchases14d:
        type:
          - "null"
          - string
      unitsSold14d:
        type:
          - "null"
          - string
      attributedSales14d:
        type:
          - "null"
          - string
      attributedTotalDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      attributedTotalAddToCartClicks14d:
        type:
          - "null"
          - string
      attributedTotalPurchases14d:
        type:
          - "null"
          - string
      totalUnitsSold14d:
        type:
          - "null"
          - string
      totalAttributedSales14d:
        type:
          - "null"
          - string
      brb_bonus_amount:
        type:
          - "null"
          - string
      brandHaloDetailPageViewsClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedAddToCartClicks14d:
        type:
          - "null"
          - string
      brandHaloAttributedPurchases14d:
        type:
          - "null"
          - string
      brandHaloUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloAttributedSales14d:
        type:
          - "null"
          - string
      attributedNewToBrandPurchases14d:
        type:
          - "null"
          - string
      attributedNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      attributedNewToBrandSales14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandPurchases14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandUnitsSold14d:
        type:
          - "null"
          - string
      brandHaloNewToBrandSales14d:
        type:
          - "null"
          - string
    title: attribution_report_performance_creative
    additionalProperties: true
  sponsored_brands_v3_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      attributionType:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      newToBrandSales14d:
        type:
          - "null"
          - number
      orders14d:
        type:
          - "null"
          - integer
      productName:
        type:
          - "null"
          - string
      sales14d:
        type:
          - "null"
          - number
      newToBrandPurchasesPercentage14d:
        type:
          - "null"
          - number
      purchasedAsin:
        type:
          - "null"
          - string
      newToBrandSalesPercentage14d:
        type:
          - "null"
          - number
      productCategory:
        type:
          - "null"
          - string
      newToBrandPurchases14d:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldPercentage14d:
        type:
          - "null"
          - number
      unitsSold14d:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      newToBrandUnitsSold14d:
        type:
          - "null"
          - integer
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
    title: sponsored_brands_v3_report_stream
    additionalProperties: true
  sponsored_display_campaigns_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      endDate:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      startDate:
        type:
          - "null"
          - string
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
      campaignBudgetAmount:
        type:
          - "null"
          - number
      campaignStatus:
        type:
          - "null"
          - string
      costType:
        type:
          - "null"
          - string
      cumulativeReach:
        type:
          - "null"
          - string
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
      newToBrandSales:
        type:
          - "null"
          - number
    title: sponsored_display_campaigns_report_stream
    additionalProperties: true
  sponsored_display_adgroups_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      bidOptimization:
        type:
          - "null"
          - string
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      endDate:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      startDate:
        type:
          - "null"
          - string
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
      cumulativeReach:
        type:
          - "null"
          - string
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
    title: sponsored_display_adgroups_report_stream
    additionalProperties: true
  sponsored_display_productads_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      bidOptimization:
        type:
          - "null"
          - string
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      cumulativeReach:
        type:
          - "null"
          - string
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      endDate:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      promotedAsin:
        type:
          - "null"
          - string
      promotedSku:
        type:
          - "null"
          - string
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      startDate:
        type:
          - "null"
          - string
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
    title: sponsored_display_productads_report_stream
    additionalProperties: true
  sponsored_display_targets_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      targetingId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      endDate:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      startDate:
        type:
          - "null"
          - string
      targetingExpression:
        type:
          - "null"
          - string
      targetingText:
        type:
          - "null"
          - string
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
    title: sponsored_display_targets_report_stream
    additionalProperties: true
  sponsored_display_asins_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      promotedAsin:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      asinBrandHalo:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      conversionsBrandHalo:
        type:
          - "null"
          - integer
      conversionsBrandHaloClicks:
        type:
          - "null"
          - integer
      endDate:
        type:
          - "null"
          - string
      promotedSku:
        type:
          - "null"
          - string
      salesBrandHalo:
        type:
          - "null"
          - integer
      salesBrandHaloClicks:
        type:
          - "null"
          - integer
      startDate:
        type:
          - "null"
          - string
      unitsSoldBrandHalo:
        type:
          - "null"
          - integer
      unitsSoldBrandHaloClicks:
        type:
          - "null"
          - integer
    title: sponsored_display_asins_report_stream
    additionalProperties: true
  sponsored_products_campaigns_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignStatus:
        type:
          - "null"
          - string
      campaignBudgetAmount:
        type:
          - "null"
          - number
      campaignRuleBasedBudgetAmount:
        type:
          - "null"
          - number
      campaignApplicableBudgetRuleId:
        type:
          - "null"
          - string
      campaignApplicableBudgetRuleName:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_campaigns_report_stream
    additionalProperties: true
  sponsored_products_adgroups_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_adgroups_report_stream
    additionalProperties: true
  sponsored_products_keywords_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      keywordId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_keywords_report_stream
    additionalProperties: true
  sponsored_products_targets_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      keywordId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      targeting:
        type:
          - "null"
          - string
      keywordType:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_targets_report_stream
    additionalProperties: true
  sponsored_products_productads_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_productads_report_stream
    additionalProperties: true
  sponsored_products_asins_keywords_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keywordId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      purchasedAsin:
        type:
          - "null"
          - string
      advertisedSku:
        type:
          - "null"
          - string
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku1d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku7d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku14d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku30d:
        type:
          - "null"
          - integer
      salesOtherSku1d:
        type:
          - "null"
          - number
      salesOtherSku7d:
        type:
          - "null"
          - number
      salesOtherSku14d:
        type:
          - "null"
          - number
      salesOtherSku30d:
        type:
          - "null"
          - number
    title: sponsored_products_asins_keywords_report_stream
    additionalProperties: true
  sponsored_products_asins_targets_report_stream:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      purchasedAsin:
        type:
          - "null"
          - string
      advertisedSku:
        type:
          - "null"
          - string
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku1d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku7d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku14d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku30d:
        type:
          - "null"
          - integer
      salesOtherSku1d:
        type:
          - "null"
          - number
      salesOtherSku7d:
        type:
          - "null"
          - number
      salesOtherSku14d:
        type:
          - "null"
          - number
      salesOtherSku30d:
        type:
          - "null"
          - number
      keywordId:
        type:
          - "null"
          - integer
      targeting:
        type:
          - "null"
          - string
      keywordType:
        type:
          - "null"
          - string
    title: sponsored_products_asins_targets_report_stream
    additionalProperties: true
  sponsored_brands_v3_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      attributionType:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      newToBrandSales14d:
        type:
          - "null"
          - number
      orders14d:
        type:
          - "null"
          - integer
      productName:
        type:
          - "null"
          - string
      sales14d:
        type:
          - "null"
          - number
      newToBrandPurchasesPercentage14d:
        type:
          - "null"
          - number
      purchasedAsin:
        type:
          - "null"
          - string
      newToBrandSalesPercentage14d:
        type:
          - "null"
          - number
      productCategory:
        type:
          - "null"
          - string
      newToBrandPurchases14d:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldPercentage14d:
        type:
          - "null"
          - number
      unitsSold14d:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      newToBrandUnitsSold14d:
        type:
          - "null"
          - integer
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
    title: sponsored_brands_v3_report_stream_daily
    additionalProperties: true
  sponsored_display_campaigns_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
      campaignBudgetAmount:
        type:
          - "null"
          - number
      campaignStatus:
        type:
          - "null"
          - string
      costType:
        type:
          - "null"
          - string
      cumulativeReach:
        type:
          - "null"
          - string
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
      newToBrandSales:
        type:
          - "null"
          - number
    title: sponsored_display_campaigns_report_stream_daily
    additionalProperties: true
  sponsored_display_adgroups_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      bidOptimization:
        type:
          - "null"
          - string
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
      cumulativeReach:
        type:
          - "null"
          - string
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
    title: sponsored_display_adgroups_report_stream_daily
    additionalProperties: true
  sponsored_display_productads_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      bidOptimization:
        type:
          - "null"
          - string
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      cumulativeReach:
        type:
          - "null"
          - string
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      impressions:
        type:
          - "null"
          - integer
      impressionsFrequencyAverage:
        type:
          - "null"
          - number
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewClicks:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewRate:
        type:
          - "null"
          - number
      newToBrandDetailPageViews:
        type:
          - "null"
          - integer
      newToBrandDetailPageViewViews:
        type:
          - "null"
          - integer
      newToBrandECPDetailPageView:
        type:
          - "null"
          - number
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      promotedAsin:
        type:
          - "null"
          - string
      promotedSku:
        type:
          - "null"
          - string
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
    title: sponsored_display_productads_report_stream_daily
    additionalProperties: true
  sponsored_display_targets_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    date:
      type:
        - "null"
        - string
    properties:
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      targetingId:
        type:
          - "null"
          - integer
      addToCart:
        type:
          - "null"
          - integer
      addToCartClicks:
        type:
          - "null"
          - integer
      addToCartRate:
        type:
          - "null"
          - number
      addToCartViews:
        type:
          - "null"
          - integer
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      brandedSearches:
        type:
          - "null"
          - integer
      brandedSearchesClicks:
        type:
          - "null"
          - integer
      brandedSearchesViews:
        type:
          - "null"
          - integer
      brandedSearchRate:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      detailPageViews:
        type:
          - "null"
          - integer
      detailPageViewsClicks:
        type:
          - "null"
          - integer
      eCPAddToCart:
        type:
          - "null"
          - number
      eCPBrandSearch:
        type:
          - "null"
          - number
      impressions:
        type:
          - "null"
          - integer
      impressionsViews:
        type:
          - "null"
          - integer
      leadFormOpens:
        type:
          - "null"
          - integer
      leads:
        type:
          - "null"
          - integer
      linkOuts:
        type:
          - "null"
          - integer
      newToBrandPurchases:
        type:
          - "null"
          - integer
      newToBrandPurchasesClicks:
        type:
          - "null"
          - integer
      newToBrandSales:
        type:
          - "null"
          - number
      newToBrandSalesClicks:
        type:
          - "null"
          - number
      newToBrandUnitsSold:
        type:
          - "null"
          - integer
      newToBrandUnitsSoldClicks:
        type:
          - "null"
          - integer
      purchases:
        type:
          - "null"
          - integer
      purchasesClicks:
        type:
          - "null"
          - integer
      purchasesPromotedClicks:
        type:
          - "null"
          - integer
      sales:
        type:
          - "null"
          - number
      salesClicks:
        type:
          - "null"
          - number
      salesPromotedClicks:
        type:
          - "null"
          - number
      targetingExpression:
        type:
          - "null"
          - string
      targetingText:
        type:
          - "null"
          - string
      unitsSold:
        type:
          - "null"
          - integer
      unitsSoldClicks:
        type:
          - "null"
          - integer
      videoCompleteViews:
        type:
          - "null"
          - integer
      videoFirstQuartileViews:
        type:
          - "null"
          - integer
      videoMidpointViews:
        type:
          - "null"
          - integer
      videoThirdQuartileViews:
        type:
          - "null"
          - integer
      videoUnmutes:
        type:
          - "null"
          - integer
      viewabilityRate:
        type:
          - "null"
          - number
      viewClickThroughRate:
        type:
          - "null"
          - number
    title: sponsored_display_targets_report_stream_daily
    additionalProperties: true
  sponsored_display_asins_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      promotedAsin:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      asinBrandHalo:
        type:
          - "null"
          - string
      addToList:
        type:
          - "null"
          - integer
      addToListFromClicks:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromClicks:
        type:
          - "null"
          - integer
      addToListFromViews:
        type:
          - "null"
          - integer
      qualifiedBorrows:
        type:
          - "null"
          - integer
      qualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrows:
        type:
          - "null"
          - integer
      royaltyQualifiedBorrowsFromViews:
        type:
          - "null"
          - integer
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      conversionsBrandHalo:
        type:
          - "null"
          - integer
      conversionsBrandHaloClicks:
        type:
          - "null"
          - integer
      promotedSku:
        type:
          - "null"
          - string
      salesBrandHalo:
        type:
          - "null"
          - integer
      salesBrandHaloClicks:
        type:
          - "null"
          - integer
      unitsSoldBrandHalo:
        type:
          - "null"
          - integer
      unitsSoldBrandHaloClicks:
        type:
          - "null"
          - integer
    title: sponsored_display_asins_report_stream_daily
    additionalProperties: true
  sponsored_products_campaigns_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignStatus:
        type:
          - "null"
          - string
      campaignBudgetAmount:
        type:
          - "null"
          - number
      campaignRuleBasedBudgetAmount:
        type:
          - "null"
          - number
      campaignApplicableBudgetRuleId:
        type:
          - "null"
          - string
      campaignApplicableBudgetRuleName:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_campaigns_report_stream_daily
    additionalProperties: true
  sponsored_products_adgroups_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_adgroups_report_stream_daily
    additionalProperties: true
  sponsored_products_keywords_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      keywordId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_keywords_report_stream_daily
    additionalProperties: true
  sponsored_products_targets_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      keywordId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      targeting:
        type:
          - "null"
          - string
      keywordType:
        type:
          - "null"
          - string
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_targets_report_stream_daily
    additionalProperties: true
  sponsored_products_productads_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      adId:
        type:
          - "null"
          - integer
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      impressions:
        type:
          - "null"
          - integer
      clicks:
        type:
          - "null"
          - integer
      cost:
        type:
          - "null"
          - number
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      purchases1d:
        type:
          - "null"
          - integer
      purchases7d:
        type:
          - "null"
          - integer
      purchases14d:
        type:
          - "null"
          - integer
      purchases30d:
        type:
          - "null"
          - integer
      purchasesSameSku1d:
        type:
          - "null"
          - integer
      purchasesSameSku7d:
        type:
          - "null"
          - integer
      purchasesSameSku14d:
        type:
          - "null"
          - integer
      purchasesSameSku30d:
        type:
          - "null"
          - integer
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      sales1d:
        type:
          - "null"
          - number
      sales7d:
        type:
          - "null"
          - number
      sales14d:
        type:
          - "null"
          - number
      sales30d:
        type:
          - "null"
          - number
      attributedSalesSameSku1d:
        type:
          - "null"
          - number
      attributedSalesSameSku7d:
        type:
          - "null"
          - number
      attributedSalesSameSku14d:
        type:
          - "null"
          - number
      attributedSalesSameSku30d:
        type:
          - "null"
          - number
      unitsSoldSameSku1d:
        type:
          - "null"
          - integer
      unitsSoldSameSku7d:
        type:
          - "null"
          - integer
      unitsSoldSameSku14d:
        type:
          - "null"
          - integer
      unitsSoldSameSku30d:
        type:
          - "null"
          - integer
    title: sponsored_products_productads_report_stream_daily
    additionalProperties: true
  sponsored_products_asins_keywords_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      keywordId:
        type:
          - "null"
          - integer
      keyword:
        type:
          - "null"
          - string
      purchasedAsin:
        type:
          - "null"
          - string
      advertisedSku:
        type:
          - "null"
          - string
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku1d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku7d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku14d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku30d:
        type:
          - "null"
          - integer
      salesOtherSku1d:
        type:
          - "null"
          - number
      salesOtherSku7d:
        type:
          - "null"
          - number
      salesOtherSku14d:
        type:
          - "null"
          - number
      salesOtherSku30d:
        type:
          - "null"
          - number
    title: sponsored_products_asins_keywords_report_stream_daily
    additionalProperties: true
  sponsored_products_asins_targets_report_stream_daily:
    type:
      - "null"
      - object
    $schema: http://json-schema.org/draft-07/schema#
    properties:
      date:
        type:
          - "null"
          - string
      profileId:
        type:
          - "null"
          - integer
      reportDate:
        type:
          - "null"
          - string
      advertisedAsin:
        type:
          - "null"
          - string
      campaignName:
        type:
          - "null"
          - string
      campaignId:
        type:
          - "null"
          - integer
      adGroupName:
        type:
          - "null"
          - string
      adGroupId:
        type:
          - "null"
          - integer
      purchasedAsin:
        type:
          - "null"
          - string
      advertisedSku:
        type:
          - "null"
          - string
      campaignBudgetCurrencyCode:
        type:
          - "null"
          - string
      matchType:
        type:
          - "null"
          - string
      unitsSoldClicks1d:
        type:
          - "null"
          - integer
      unitsSoldClicks7d:
        type:
          - "null"
          - integer
      unitsSoldClicks14d:
        type:
          - "null"
          - integer
      unitsSoldClicks30d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku1d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku7d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku14d:
        type:
          - "null"
          - integer
      unitsSoldOtherSku30d:
        type:
          - "null"
          - integer
      salesOtherSku1d:
        type:
          - "null"
          - number
      salesOtherSku7d:
        type:
          - "null"
          - number
      salesOtherSku14d:
        type:
          - "null"
          - number
      salesOtherSku30d:
        type:
          - "null"
          - number
      keywordId:
        type:
          - "null"
          - integer
      targeting:
        type:
          - "null"
          - string
      keywordType:
        type:
          - "null"
          - string
    title: sponsored_products_asins_targets_report_stream_daily
    additionalProperties: true

concurrency_level:
  type: ConcurrencyLevel
  default_concurrency: 10
  max_concurrency: 10
